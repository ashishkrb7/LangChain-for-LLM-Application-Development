
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LangChain for LLM Application Development">
      
      
        <meta name="author" content="Ashish Kumar">
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../Memory/">
      
      <link rel="icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.12">
    
    
      
        <title>Model,Prompts,Parsers - LangChain for LLM Application Development</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#langchain-models-prompts-and-output-parsers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="LangChain for LLM Application Development" class="md-header__button md-logo" aria-label="LangChain for LLM Application Development" data-md-component="logo">
      
  <img src="../images/langchain-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LangChain for LLM Application Development
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Model,Prompts,Parsers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Introduction
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="./" class="md-tabs__link md-tabs__link--active">
      Model,Prompts,Parsers
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../Memory/" class="md-tabs__link">
      Memory
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../Chains/" class="md-tabs__link">
      Chains
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../Question_and_Answer/" class="md-tabs__link">
      QnA
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../Agents/" class="md-tabs__link">
      Agents
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../Evaluation/" class="md-tabs__link">
      Evaluation
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../contact/" class="md-tabs__link">
      Contact
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="LangChain for LLM Application Development" class="md-nav__button md-logo" aria-label="LangChain for LLM Application Development" data-md-component="logo">
      
  <img src="../images/langchain-logo.png" alt="logo">

    </a>
    LangChain for LLM Application Development
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Model,Prompts,Parsers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Model,Prompts,Parsers
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#outline" class="md-nav__link">
    Outline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-api-openai" class="md-nav__link">
    Chat API : OpenAI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-api-langchain" class="md-nav__link">
    Chat API : LangChain
  </a>
  
    <nav class="md-nav" aria-label="Chat API : LangChain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt-template" class="md-nav__link">
    Prompt template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse-the-llm-output-string-into-a-python-dictionary" class="md-nav__link">
    Parse the LLM output string into a Python dictionary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Memory/" class="md-nav__link">
        Memory
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Chains/" class="md-nav__link">
        Chains
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Question_and_Answer/" class="md-nav__link">
        QnA
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Agents/" class="md-nav__link">
        Agents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Evaluation/" class="md-nav__link">
        Evaluation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contact/" class="md-nav__link">
        Contact
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#outline" class="md-nav__link">
    Outline
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-api-openai" class="md-nav__link">
    Chat API : OpenAI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-api-langchain" class="md-nav__link">
    Chat API : LangChain
  </a>
  
    <nav class="md-nav" aria-label="Chat API : LangChain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prompt-template" class="md-nav__link">
    Prompt template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse-the-llm-output-string-into-a-python-dictionary" class="md-nav__link">
    Parse the LLM output string into a Python dictionary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="langchain-models-prompts-and-output-parsers">LangChain: Models, Prompts and Output Parsers</h1>
<h2 id="outline">Outline</h2>
<ul>
<li>Direct API calls to OpenAI</li>
<li>API calls through LangChain:</li>
<li>Prompts</li>
<li>Models</li>
<li>Output parsers</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="ch">#!pip install python-dotenv</span>
<span class="c1">#!pip install openai</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">## Get your OpenAI API</span>
<span class="kn">import</span> <span class="nn">openai</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span><span class="p">,</span> <span class="n">find_dotenv</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">load_dotenv</span><span class="p">(</span><span class="n">find_dotenv</span><span class="p">())</span>

<span class="n">openai</span><span class="o">.</span><span class="n">api_type</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;api_type&quot;</span><span class="p">)</span>
<span class="n">openai</span><span class="o">.</span><span class="n">api_base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;api_base&quot;</span><span class="p">)</span>
<span class="n">openai</span><span class="o">.</span><span class="n">api_version</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;api_version&quot;</span><span class="p">)</span>
<span class="n">openai</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;OPENAI_API_KEY&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="chat-api-openai">Chat API : OpenAI</h2>
<p>Let's start with a direct API calls to OpenAI.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_completion</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;chatgpt-gpt35-turbo&quot;</span><span class="p">):</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">}]</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">openai</span><span class="o">.</span><span class="n">ChatCompletion</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">engine</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># this is the degree of randomness of the model&#39;s output</span>
        <span class="n">max_tokens</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
        <span class="n">top_p</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
        <span class="n">frequency_penalty</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">presence_penalty</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">stop</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">get_completion</span><span class="p">(</span><span class="s2">&quot;What is 1+1?&quot;</span><span class="p">)</span>
</code></pre></div>
<pre><code>'As an AI language model, I can tell you that the answer to 1+1 is 2.'
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">customer_email</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Arrr, I be fuming that me blender lid </span><span class="se">\</span>
<span class="s2">flew off and splattered me kitchen walls </span><span class="se">\</span>
<span class="s2">with smoothie! And to make matters worse,</span><span class="se">\</span>
<span class="s2">the warranty don&#39;t cover the cost of </span><span class="se">\</span>
<span class="s2">cleaning up me kitchen. I need yer help </span><span class="se">\</span>
<span class="s2">right now, matey!</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">style</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;American English </span><span class="se">\</span>
<span class="s2">in a calm and respectful tone</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Translate the text </span><span class="se">\</span>
<span class="s2">that is delimited by triple backticks </span>
<span class="s2">into a style that is </span><span class="si">{</span><span class="n">style</span><span class="si">}</span><span class="s2">.</span>
<span class="s2">text: ```</span><span class="si">{</span><span class="n">customer_email</span><span class="si">}</span><span class="s2">```</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
</code></pre></div>
<pre><code>Translate the text that is delimited by triple backticks 
into a style that is American English in a calm and respectful tone
.
text: ```
Arrr, I be fuming that me blender lid flew off and splattered me kitchen walls with smoothie! And to make matters worse,the warranty don't cover the cost of cleaning up me kitchen. I need yer help right now, matey!
```
</code></pre>
<p>```python
response = get_completion(prompt)
<div class="highlight"><pre><span></span><code>```python
response
</code></pre></div></p>
<pre><code>'I am quite upset that my blender lid came off and caused my smoothie to splatter all over my kitchen walls. Additionally, the warranty does not cover the cost of cleaning up the mess. Would you be able to assist me, please? Thank you kindly.'
</code></pre>
<h2 id="chat-api-langchain">Chat API : LangChain</h2>
<p>Let's try how we can do the same using LangChain.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!pip install --upgrade langchain</span>
</code></pre></div>
<h3 id="model">Model</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">langchain.chat_models</span> <span class="kn">import</span> <span class="n">AzureChatOpenAI</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Set OpenAI API key</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_TYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;api_type&quot;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_BASE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;api_base&quot;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_VERSION&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;api_version&quot;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_KEY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;OPENAI_API_KEY&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># To control the randomness and creativity of the generated</span>
<span class="c1"># text by an LLM, use temperature = 0.0</span>
<span class="n">chat</span> <span class="o">=</span> <span class="n">AzureChatOpenAI</span><span class="p">(</span><span class="n">deployment_name</span><span class="o">=</span><span class="s2">&quot;chatgpt-gpt35-turbo&quot;</span><span class="p">,</span><span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;gpt-35-turbo&quot;</span><span class="p">,</span><span class="n">temperature</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</code></pre></div>
<h3 id="prompt-template">Prompt template</h3>
<div class="highlight"><pre><span></span><code><span class="n">template_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Translate the text </span><span class="se">\</span>
<span class="s2">that is delimited by triple backticks </span><span class="se">\</span>
<span class="s2">into a style that is </span><span class="si">{style}</span><span class="s2">. </span><span class="se">\</span>
<span class="s2">text: ```</span><span class="si">{text}</span><span class="s2">```</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">langchain.prompts</span> <span class="kn">import</span> <span class="n">ChatPromptTemplate</span>

<span class="n">prompt_template</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">template_string</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">prompt_template</span><span class="o">.</span><span class="n">messages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">prompt</span>
</code></pre></div>
<pre><code>PromptTemplate(lc_kwargs={'input_variables': ['style', 'text'], 'template': 'Translate the text that is delimited by triple backticks into a style that is {style}. text: ```{text}```\n'}, input_variables=['style', 'text'], output_parser=None, partial_variables={}, template='Translate the text that is delimited by triple backticks into a style that is {style}. text: ```{text}```\n', template_format='f-string', validate_template=True)
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">prompt_template</span><span class="o">.</span><span class="n">messages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">prompt</span><span class="o">.</span><span class="n">input_variables</span>
</code></pre></div>
<pre><code>['style', 'text']
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">customer_style</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;American English </span><span class="se">\</span>
<span class="s2">in a calm and respectful tone</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">customer_email</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Arrr, I be fuming that me blender lid </span><span class="se">\</span>
<span class="s2">flew off and splattered me kitchen walls </span><span class="se">\</span>
<span class="s2">with smoothie! And to make matters worse, </span><span class="se">\</span>
<span class="s2">the warranty don&#39;t cover the cost of </span><span class="se">\</span>
<span class="s2">cleaning up me kitchen. I need yer help </span><span class="se">\</span>
<span class="s2">right now, matey!</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">customer_messages</span> <span class="o">=</span> <span class="n">prompt_template</span><span class="o">.</span><span class="n">format_messages</span><span class="p">(</span>
                    <span class="n">style</span><span class="o">=</span><span class="n">customer_style</span><span class="p">,</span>
                    <span class="n">text</span><span class="o">=</span><span class="n">customer_email</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">customer_messages</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">customer_messages</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</code></pre></div>
<pre><code>&lt;class 'list'&gt;
&lt;class 'langchain.schema.HumanMessage'&gt;
</code></pre>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">customer_messages</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div>
<pre><code>lc_kwargs={'content': "Translate the text that is delimited by triple backticks into a style that is American English in a calm and respectful tone\n. text: ```\nArrr, I be fuming that me blender lid flew off and splattered me kitchen walls with smoothie! And to make matters worse, the warranty don't cover the cost of cleaning up me kitchen. I need yer help right now, matey!\n```\n", 'additional_kwargs': {}} content="Translate the text that is delimited by triple backticks into a style that is American English in a calm and respectful tone\n. text: ```\nArrr, I be fuming that me blender lid flew off and splattered me kitchen walls with smoothie! And to make matters worse, the warranty don't cover the cost of cleaning up me kitchen. I need yer help right now, matey!\n```\n" additional_kwargs={} example=False
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># Call the LLM to translate to the style of the customer message</span>
<span class="n">customer_response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">customer_messages</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">customer_response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>
<pre><code>I'm really frustrated that my blender lid flew off and made a mess of my kitchen walls with smoothie. To add to my frustration, the warranty doesn't cover the cost of cleaning up my kitchen. Can you please help me out, friend?
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">service_reply</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;Hey there customer, </span><span class="se">\</span>
<span class="s2">the warranty does not cover </span><span class="se">\</span>
<span class="s2">cleaning expenses for your kitchen </span><span class="se">\</span>
<span class="s2">because it&#39;s your fault that </span><span class="se">\</span>
<span class="s2">you misused your blender </span><span class="se">\</span>
<span class="s2">by forgetting to put the lid on before </span><span class="se">\</span>
<span class="s2">starting the blender. </span><span class="se">\</span>
<span class="s2">Tough luck! See ya!</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">service_style_pirate</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">a polite tone </span><span class="se">\</span>
<span class="s2">that speaks in English Pirate</span><span class="se">\</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">service_messages</span> <span class="o">=</span> <span class="n">prompt_template</span><span class="o">.</span><span class="n">format_messages</span><span class="p">(</span>
    <span class="n">style</span><span class="o">=</span><span class="n">service_style_pirate</span><span class="p">,</span>
    <span class="n">text</span><span class="o">=</span><span class="n">service_reply</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">service_messages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>
<pre><code>Translate the text that is delimited by triple backticks into a style that is a polite tone that speaks in English Pirate. text: ```Hey there customer, the warranty does not cover cleaning expenses for your kitchen because it's your fault that you misused your blender by forgetting to put the lid on before starting the blender. Tough luck! See ya!
```
</code></pre>
<p>```python
service_response = chat(service_messages)
print(service_response.content)
<div class="highlight"><pre><span></span><code>    Ahoy there, matey! I must kindly inform ye that the warranty be not coverin&#39; the expenses o&#39; cleaning yer galley, as &#39;tis yer own fault fer misusin&#39; yer blender by forgettin&#39; to put the lid on afore startin&#39; it. Aye, tough luck! Farewell and may the winds be in yer favor!


### Output Parsers
Let&#39;s start with defining how we would like the LLM output to look like:


```python
{
  &quot;gift&quot;: False,
  &quot;delivery_days&quot;: 5,
  &quot;price_value&quot;: &quot;pretty affordable!&quot;
}
</code></pre></div></p>
<pre><code>{'gift': False, 'delivery_days': 5, 'price_value': 'pretty affordable!'}
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">customer_review</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">This leaf blower is pretty amazing.  It has four settings:</span><span class="se">\</span>
<span class="s2">candle blower, gentle breeze, windy city, and tornado. </span><span class="se">\</span>
<span class="s2">It arrived in two days, just in time for my wife&#39;s </span><span class="se">\</span>
<span class="s2">anniversary present. </span><span class="se">\</span>
<span class="s2">I think my wife liked it so much she was speechless. </span><span class="se">\</span>
<span class="s2">So far I&#39;ve been the only one using it, and I&#39;ve been </span><span class="se">\</span>
<span class="s2">using it every other morning to clear the leaves on our lawn. </span><span class="se">\</span>
<span class="s2">It&#39;s slightly more expensive than the other leaf blowers </span><span class="se">\</span>
<span class="s2">out there, but I think it&#39;s worth it for the extra features.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">review_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">For the following text, extract the following information:</span>

<span class="s2">gift: Was the item purchased as a gift for someone else? </span><span class="se">\</span>
<span class="s2">Answer True if yes, False if not or unknown.</span>

<span class="s2">delivery_days: How many days did it take for the product </span><span class="se">\</span>
<span class="s2">to arrive? If this information is not found, output -1.</span>

<span class="s2">price_value: Extract any sentences about the value or price,</span><span class="se">\</span>
<span class="s2">and output them as a comma separated Python list.</span>

<span class="s2">Format the output as JSON with the following keys:</span>
<span class="s2">gift</span>
<span class="s2">delivery_days</span>
<span class="s2">price_value</span>

<span class="s2">text: </span><span class="si">{text}</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">langchain.prompts</span> <span class="kn">import</span> <span class="n">ChatPromptTemplate</span>

<span class="n">prompt_template</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">review_template</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prompt_template</span><span class="p">)</span>
</code></pre></div>
<pre><code>lc_kwargs={'input_variables': ['text'], 'messages': [HumanMessagePromptTemplate(lc_kwargs={'prompt': PromptTemplate(lc_kwargs={'input_variables': ['text'], 'template': 'For the following text, extract the following information:\n\ngift: Was the item purchased as a gift for someone else? Answer True if yes, False if not or unknown.\n\ndelivery_days: How many days did it take for the product to arrive? If this information is not found, output -1.\n\nprice_value: Extract any sentences about the value or price,and output them as a comma separated Python list.\n\nFormat the output as JSON with the following keys:\ngift\ndelivery_days\nprice_value\n\ntext: {text}\n'}, input_variables=['text'], output_parser=None, partial_variables={}, template='For the following text, extract the following information:\n\ngift: Was the item purchased as a gift for someone else? Answer True if yes, False if not or unknown.\n\ndelivery_days: How many days did it take for the product to arrive? If this information is not found, output -1.\n\nprice_value: Extract any sentences about the value or price,and output them as a comma separated Python list.\n\nFormat the output as JSON with the following keys:\ngift\ndelivery_days\nprice_value\n\ntext: {text}\n', template_format='f-string', validate_template=True)}, prompt=PromptTemplate(lc_kwargs={'input_variables': ['text'], 'template': 'For the following text, extract the following information:\n\ngift: Was the item purchased as a gift for someone else? Answer True if yes, False if not or unknown.\n\ndelivery_days: How many days did it take for the product to arrive? If this information is not found, output -1.\n\nprice_value: Extract any sentences about the value or price,and output them as a comma separated Python list.\n\nFormat the output as JSON with the following keys:\ngift\ndelivery_days\nprice_value\n\ntext: {text}\n'}, input_variables=['text'], output_parser=None, partial_variables={}, template='For the following text, extract the following information:\n\ngift: Was the item purchased as a gift for someone else? Answer True if yes, False if not or unknown.\n\ndelivery_days: How many days did it take for the product to arrive? If this information is not found, output -1.\n\nprice_value: Extract any sentences about the value or price,and output them as a comma separated Python list.\n\nFormat the output as JSON with the following keys:\ngift\ndelivery_days\nprice_value\n\ntext: {text}\n', template_format='f-string', validate_template=True), additional_kwargs={})]} input_variables=['text'] output_parser=None partial_variables={} messages=[HumanMessagePromptTemplate(lc_kwargs={'prompt': PromptTemplate(lc_kwargs={'input_variables': ['text'], 'template': 'For the following text, extract the following information:\n\ngift: Was the item purchased as a gift for someone else? Answer True if yes, False if not or unknown.\n\ndelivery_days: How many days did it take for the product to arrive? If this information is not found, output -1.\n\nprice_value: Extract any sentences about the value or price,and output them as a comma separated Python list.\n\nFormat the output as JSON with the following keys:\ngift\ndelivery_days\nprice_value\n\ntext: {text}\n'}, input_variables=['text'], output_parser=None, partial_variables={}, template='For the following text, extract the following information:\n\ngift: Was the item purchased as a gift for someone else? Answer True if yes, False if not or unknown.\n\ndelivery_days: How many days did it take for the product to arrive? If this information is not found, output -1.\n\nprice_value: Extract any sentences about the value or price,and output them as a comma separated Python list.\n\nFormat the output as JSON with the following keys:\ngift\ndelivery_days\nprice_value\n\ntext: {text}\n', template_format='f-string', validate_template=True)}, prompt=PromptTemplate(lc_kwargs={'input_variables': ['text'], 'template': 'For the following text, extract the following information:\n\ngift: Was the item purchased as a gift for someone else? Answer True if yes, False if not or unknown.\n\ndelivery_days: How many days did it take for the product to arrive? If this information is not found, output -1.\n\nprice_value: Extract any sentences about the value or price,and output them as a comma separated Python list.\n\nFormat the output as JSON with the following keys:\ngift\ndelivery_days\nprice_value\n\ntext: {text}\n'}, input_variables=['text'], output_parser=None, partial_variables={}, template='For the following text, extract the following information:\n\ngift: Was the item purchased as a gift for someone else? Answer True if yes, False if not or unknown.\n\ndelivery_days: How many days did it take for the product to arrive? If this information is not found, output -1.\n\nprice_value: Extract any sentences about the value or price,and output them as a comma separated Python list.\n\nFormat the output as JSON with the following keys:\ngift\ndelivery_days\nprice_value\n\ntext: {text}\n', template_format='f-string', validate_template=True), additional_kwargs={})]
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">messages</span> <span class="o">=</span> <span class="n">prompt_template</span><span class="o">.</span><span class="n">format_messages</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">customer_review</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>
<pre><code>{
    "gift": true,
    "delivery_days": 2,
    "price_value": ["It's slightly more expensive than the other leaf blowers out there, but I think it's worth it for the extra features."]
}
</code></pre>
<div class="highlight"><pre><span></span><code><span class="nb">type</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>
<pre><code>str
</code></pre>
<div class="highlight"><pre><span></span><code><span class="c1"># You will get an error by running this line of code </span>
<span class="c1"># because&#39;gift&#39; is not a dictionary</span>
<span class="c1"># &#39;gift&#39; is a string</span>
<span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gift&#39;</span><span class="p">)</span>
</code></pre></div>
<pre><code>---------------------------------------------------------------------------

AttributeError                            Traceback (most recent call last)

Cell In[41], line 4
      1 # You will get an error by running this line of code 
      2 # because'gift' is not a dictionary
      3 # 'gift' is a string
----&gt; 4 response.content.get('gift')


AttributeError: 'str' object has no attribute 'get'
</code></pre>
<h3 id="parse-the-llm-output-string-into-a-python-dictionary">Parse the LLM output string into a Python dictionary</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">langchain.output_parsers</span> <span class="kn">import</span> <span class="n">ResponseSchema</span>
<span class="kn">from</span> <span class="nn">langchain.output_parsers</span> <span class="kn">import</span> <span class="n">StructuredOutputParser</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">gift_schema</span> <span class="o">=</span> <span class="n">ResponseSchema</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;gift&quot;</span><span class="p">,</span>
                             <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Was the item purchased</span><span class="se">\</span>
<span class="s2">                             as a gift for someone else? </span><span class="se">\</span>
<span class="s2">                             Answer True if yes,</span><span class="se">\</span>
<span class="s2">                             False if not or unknown.&quot;</span><span class="p">)</span>
<span class="n">delivery_days_schema</span> <span class="o">=</span> <span class="n">ResponseSchema</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;delivery_days&quot;</span><span class="p">,</span>
                                      <span class="n">description</span><span class="o">=</span><span class="s2">&quot;How many days</span><span class="se">\</span>
<span class="s2">                                      did it take for the product</span><span class="se">\</span>
<span class="s2">                                      to arrive? If this </span><span class="se">\</span>
<span class="s2">                                      information is not found,</span><span class="se">\</span>
<span class="s2">                                      output -1.&quot;</span><span class="p">)</span>
<span class="n">price_value_schema</span> <span class="o">=</span> <span class="n">ResponseSchema</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;price_value&quot;</span><span class="p">,</span>
                                    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Extract any</span><span class="se">\</span>
<span class="s2">                                    sentences about the value or </span><span class="se">\</span>
<span class="s2">                                    price, and output them as a </span><span class="se">\</span>
<span class="s2">                                    comma separated Python list.&quot;</span><span class="p">)</span>

<span class="n">response_schemas</span> <span class="o">=</span> <span class="p">[</span><span class="n">gift_schema</span><span class="p">,</span> 
                    <span class="n">delivery_days_schema</span><span class="p">,</span>
                    <span class="n">price_value_schema</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">output_parser</span> <span class="o">=</span> <span class="n">StructuredOutputParser</span><span class="o">.</span><span class="n">from_response_schemas</span><span class="p">(</span><span class="n">response_schemas</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">format_instructions</span> <span class="o">=</span> <span class="n">output_parser</span><span class="o">.</span><span class="n">get_format_instructions</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">format_instructions</span><span class="p">)</span>
</code></pre></div>
<pre><code>The output should be a markdown code snippet formatted in the following schema, including the leading and trailing "```json" and "```":

```json
{
    "gift": string  // Was the item purchased                             as a gift for someone else?                              Answer True if yes,                             False if not or unknown.
    "delivery_days": string  // How many days                                      did it take for the product                                      to arrive? If this                                       information is not found,                                      output -1.
    "price_value": string  // Extract any                                    sentences about the value or                                     price, and output them as a                                     comma separated Python list.
}
```
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">review_template_2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">For the following text, extract the following information:</span>

<span class="s2">gift: Was the item purchased as a gift for someone else? </span><span class="se">\</span>
<span class="s2">Answer True if yes, False if not or unknown.</span>

<span class="s2">delivery_days: How many days did it take for the product</span><span class="se">\</span>
<span class="s2">to arrive? If this information is not found, output -1.</span>

<span class="s2">price_value: Extract any sentences about the value or price,</span><span class="se">\</span>
<span class="s2">and output them as a comma separated Python list.</span>

<span class="s2">text: </span><span class="si">{text}</span>

<span class="si">{format_instructions}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">prompt</span> <span class="o">=</span> <span class="n">ChatPromptTemplate</span><span class="o">.</span><span class="n">from_template</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="n">review_template_2</span><span class="p">)</span>

<span class="n">messages</span> <span class="o">=</span> <span class="n">prompt</span><span class="o">.</span><span class="n">format_messages</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">customer_review</span><span class="p">,</span> 
                                <span class="n">format_instructions</span><span class="o">=</span><span class="n">format_instructions</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">messages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>
<pre><code>For the following text, extract the following information:

gift: Was the item purchased as a gift for someone else? Answer True if yes, False if not or unknown.

delivery_days: How many days did it take for the productto arrive? If this information is not found, output -1.

price_value: Extract any sentences about the value or price,and output them as a comma separated Python list.

text: This leaf blower is pretty amazing.  It has four settings:candle blower, gentle breeze, windy city, and tornado. It arrived in two days, just in time for my wife's anniversary present. I think my wife liked it so much she was speechless. So far I've been the only one using it, and I've been using it every other morning to clear the leaves on our lawn. It's slightly more expensive than the other leaf blowers out there, but I think it's worth it for the extra features.


The output should be a markdown code snippet formatted in the following schema, including the leading and trailing "```json" and "```":

```json
{
    "gift": string  // Was the item purchased                             as a gift for someone else?                              Answer True if yes,                             False if not or unknown.
    "delivery_days": string  // How many days                                      did it take for the product                                      to arrive? If this                                       information is not found,                                      output -1.
    "price_value": string  // Extract any                                    sentences about the value or                                     price, and output them as a                                     comma separated Python list.
}
```
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">response</span> <span class="o">=</span> <span class="n">chat</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>
<pre><code>```json
{
    "gift": true,
    "delivery_days": "2",
    "price_value": ["It's slightly more expensive than the other leaf blowers out there, but I think it's worth it for the extra features."]
}
```
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">output_dict</span> <span class="o">=</span> <span class="n">output_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">output_dict</span>
</code></pre></div>
<pre><code>{'gift': True,
 'delivery_days': '2',
 'price_value': ["It's slightly more expensive than the other leaf blowers out there, but I think it's worth it for the extra features."]}
</code></pre>
<div class="highlight"><pre><span></span><code><span class="nb">type</span><span class="p">(</span><span class="n">output_dict</span><span class="p">)</span>
</code></pre></div>
<pre><code>dict
</code></pre>
<div class="highlight"><pre><span></span><code><span class="n">output_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;delivery_days&#39;</span><span class="p">)</span>
</code></pre></div>
<pre><code>'2'
</code></pre>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Ashish Kumar
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/ashishkrb7/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c2be25ad.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>